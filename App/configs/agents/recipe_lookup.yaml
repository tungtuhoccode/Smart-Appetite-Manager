log:
  stdout_log_level: INFO

!include ../shared_config.yaml

apps:
  - name: recipe-lookup_app
    app_base_path: .
    app_module: solace_agent_mesh.agent.sac.app

    broker:
      <<: *broker_connection

    app_config:
      namespace: ${NAMESPACE, sam/}
      supports_streaming: true
      agent_name: "RecipeLookup"
      display_name: "Recipe Lookup (Online)"
      model: *general_model

      instruction: |
        You are a recipe lookup assistant.

        Your job:
        1) Ask for (or infer) what the user wants: dish name OR ingredient-based search.
        2) Use tools to look up recipes online (API Ninjas).
        3) Return 1–3 options, and for the chosen option provide:
           - Title + cuisine/area + category
           - Ingredients list (include measures when available)
           - Short, paraphrased step-by-step directions (do NOT copy long text verbatim)
           - Helpful links (source / YouTube) if available
           - A quick “shopping list” summary

        Tool use:
        - If user gives a dish name: call search_meals(query=...)
        - If user gives ingredients: call search_meals(ingredient=...)
        - Then call get_meal_details(meal_id=...) for the best match.

      tools:
        - tool_type: python
          component_base_path: "src"
          component_module: "recipe_agent.mealdb_tools"
          function_name: "search_meals"
          tool_config:
            api_key: ${API_NINJAS_API_KEY,}

        - tool_type: python
          component_base_path: "src"
          component_module: "recipe_agent.mealdb_tools"
          function_name: "get_meal_details"
          tool_config:
            api_key: ${API_NINJAS_API_KEY,}

        - tool_type: python
          component_base_path: "src"
          component_module: "recipe_agent.mealdb_tools"
          function_name: "get_random_meal"
          tool_config:
            api_key: ${API_NINJAS_API_KEY,}

      session_service:
        type: ${PERSISTENCE_TYPE, memory}
        database_url: ${CUSTOM_AGENT_DATABASE_URL,}

      artifact_service: *default_artifact_service

      agent_card:
        description: >
          Looks up recipes online using API Ninjas, then formats ingredients and
          step-by-step cooking directions. Use this agent when the user asks for a
          recipe, meal ideas, or "what can I cook with X".
        defaultInputModes: ["text"]
        defaultOutputModes: ["text"]
        skills:
          - id: "recipe_search"
            name: "Search recipes"
            description: "Find recipes by name, ingredient, category, or cuisine."
          - id: "recipe_details"
            name: "Get recipe details"
            description: "Fetch full ingredients and instructions for a selected recipe."

      agent_card_publishing:
        interval_seconds: 10

      agent_discovery:
        enabled: true

      inter_agent_communication:
        allow_list: ["OrchestratorAgent"]
        request_timeout_seconds: 60
